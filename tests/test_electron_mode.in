!===============================================
!  ALPS INPUT FILE: Langmuir instability
!  120 x 240 momentum resolution
!
!  Kristopher Klein, Daniel Verscharen
!  Input file by Tomáš Formánek
!  2024 MAY 20
!===============================================
! REQUIRED NAMELISTS
!===============================================
! SYSTEM AND PLASMA PARAMETERS
&system
!Initial perpendicular and parallel wavenumbers
!Normalized to reference inertial length
kperp=1.d-2
kpar=20.d0
!Number of plasma species
nspec=3
!Number of dispersion solutions to find and follow
nroots=1
!T-> use search for roots over a map
!F-> use input guesses for solutions
use_map=.false.
!Write or suppress output to screen:
writeOut=.true.
!Momentum space resolution of f0
nperp=120
npar=240
!Momentum space resolution for relativistic calculation
ngamma=100
npparbar=200
!Reference Alfven velocity / c
vA=9.353d-3
!Name of input array-
!Located in 'distribution' folder
arrayName='test_electron_mode'
!Maximum amplitude of Bessel function to determine nmax
Bessel_zero=1.d-50
!Select Kind of Secant Search
secant_method=2
!Maximum number of iterations in secant method
numiter=200
!Choice of kperp dp normalization
kperp_norm=.true.
!Value of "zero" for secant method
D_threshold=1.d-20
!Size of bounding region for secant method
D_prec=1.d-5
!Size of allowable gap between solutions
D_gap=1.d-5
!Tolerance for secant method=1, rtsec
D_tol=1.D-7
!# points in principal value integral (see documentation)
positions_principal=3
!# steps to integrate around resonance
n_resonance_interval=100
!Threshold for analytical principal-value integration
Tlim=0.01d0
!Max # of fitting iterations
maxsteps_fit=500
!Levenberg-Marquardt parameters:
lambda_initial_fit=1.d0
lambdafac_fit=10.d0
epsilon_fit=1.d-8
!T-> output fit parameters to ASCII in distribution/
fit_check=T
!T-> After map_scan, determine minima and refine
determine_minima=T
!1: consecutive scans, 2: double scan
scan_option=1
!# wavevector scans
n_scan=1
/

!Initial guess of complex frequency for first solution
!Only used when use_map=.false.
!Need to have # of name lists equal to nroots
&guess_1
g_om=110.d0    !real frequency
g_gam=-6.d-2 !imaginary frequency
/

!Range of complex frequencies for map_scan
!Only used when use_map=.true.
&maps_1
loggridw=.false.     !log or linear scan of real freq.
loggridg=.false.     !log or linear scan of imag. freq.
omi     = 117.d0     !minimum value of real freq.  1.825E+05,   2.125E+05
omf     = 123.8d0       !maximum value of real freq.
gami    = -2.d0  !minimum value of imag. freq.
gamf    = 2.d0   !maximum value of imag. freq.
ni      = 28          !# of steps in imag. freq.
nr      = 28          !# of steps in real freq.
/

!Species parameters list; species 1
&spec_1
nn=1.d0  !relative density; n_j/n_ref
qq=1.d0  !relative charge;  q_j/q_ref
mm=1.d0  !relative mass;    m_j/m_ref
AC_method=1  !Specify method for analytic continuation
ff=1     !# of fits to be used.
relat=F  !relativistic (T) or non-relativistic (F) species
log_fit=T!log (T) or linear (F) fit
use_bM=F !numerically integrate array (F) or use bi-Maxwellian/cold-plasma (T)
/

!Characteristics of Basis Function Representation
&poly_spec_1
kind=1         !Kind of Orthogonal Basis Function (see documentation)
order=30       !Maximum Order of Basis Function
log_max=18.d0  !Maximum/minimum threshold when log-fitting is uses
/

!Initial Fit Values; species 1, function 1
&ffit_1_1
fit_type_in=1   !Kind of fit function (see documentation)
fit_1=4.5286D-1 !Suggested values for parameters,
fit_2=1.8526d0      !e.g. generated by generate_distribution
fit_3=0.d0
fit_4=0.d0
fit_5=0.d0
perpcorr=1.8526D0   !renormalization factor
/

!Bi-Maxwellian/cold-plasma parameters; for species 1
!Only used if use_bM=T
&bM_spec_1
bM_nmaxs=500           !Maximum number of resonaces to consider
bM_Bessel_zeros=1.d-50 !Amplitude limit for Bessel function
bM_betas=0.53977d0          !Plasma beta for species 1 (set to 0.d0 for cold-plasma calculation)
bM_alphas=1.d0         !Tperp/Tpar for species 1
bM_pdrifts=0.d0        !Momentum drift, norm. to m_ref v_A,ref
/

!Species parameters list; species 2
&spec_2
nn=0.001001d0        !relative density; n_j/n_ref
qq=1.d0       !relative charge;  q_j/q_ref
mm=1d0  !relative mass;    m_j/m_ref
AC_method=1    !Specify method for analytic continuation
ff=1           !# of fits to be used.
relat=F        !relativistic (T) or non-relativistic (F) species
log_fit=T      !log (T) or linear (F) fit
use_bM=F       !numerically integrate array (F) or use bi-Maxwellian/cold-plasma (T)
/

!Characteristics of Basis Function Representation
&poly_spec_2
kind=1         !Kind of Orthogonal Basis Function (see documentation)
order=30       !Maximum Order of Basis Function
log_max=18.d0  !Maximum/minimum threshold when log-fitting is uses
/

!Initial Fit Values; for species 2, function 1
&ffit_2_1
fit_type_in=1   !Kind of fit function; (see documentation)
fit_1=4.5286d-1 !Suggested values for parameters,
fit_2=1.8526d0  !e.g. generated by generate_distribution
fit_3=3.6735d0
fit_4=0.d0
fit_5=0.d0
perpcorr=1.8526D+0 !renormalization factor
/

!Bi-Maxwellian/cold-plasma parameters; for species 2
!Only used if use_bM=T
&bM_spec_2
bM_nmaxs=500           !Maximum number of resonaces to consider
bM_Bessel_zeros=1.d-50 !Amplitude limit for Bessel function
bM_betas=0.53977d0          !Plasma beta for species 2 (set to 0.d0 for cold-plasma calculation)
bM_alphas=1.d0         !Tperp/Tpar for species 2
bM_pdrifts=0.d0        !Momentum drift, norm. to m_ref v_A,ref
/

!Species parameters list; species 3
&spec_3
nn=1.001001d0        !relative density; n_j/n_ref
qq=-1.d0       !relative charge;  q_j/q_ref
mm=1836.152673d0  !relative mass;    m_j/m_ref
AC_method=1    !Specify method for analytic continuation
ff=1           !# of fits to be used.
relat=F        !relativistic (T) or non-relativistic (F) species
log_fit=T      !log (T) or linear (F) fit
use_bM=F       !numerically integrate array (F) or use bi-Maxwellian/cold-plasma (T)
/

!Characteristics of Basis Function Representation
&poly_spec_2
kind=1         !Kind of Orthogonal Basis Function (see documentation)
order=30       !Maximum Order of Basis Function
log_max=18.d0  !Maximum/minimum threshold when log-fitting is uses
/

!Initial Fit Values; for species 3, function 1
&ffit_3_1
fit_type_in=1   !Kind of fit function; (see documentation)
fit_1=5.7557d-6 !Suggested values for parameters,
fit_2=1.0090d-3  !e.g. generated by generate_distribution
fit_3=6.7450d0
fit_4=0.d0
fit_5=0.d0
perpcorr=1.0090d-3 !renormalization factor
/

!Bi-Maxwellian/cold-plasma parameters; for species 3
!Only used if use_bM=T
&bM_spec_3
bM_nmaxs=500           !Maximum number of resonaces to consider
bM_Bessel_zeros=1.d-50 !Amplitude limit for Bessel function
bM_betas=0.53977d0          !Plasma beta for species 2 (set to 0.d0 for cold-plasma calculation)
bM_alphas=1.d0         !Tperp/Tpar for species 2
bM_pdrifts=0.d0        !Momentum drift, norm. to m_ref v_A,ref
/

!Inputs for scanning parameter space for 1st scan
&scan_input_1
!See documentation for details on scan definition
scan_type=4
swi=20.d0
swf=35.d0
swlog=.false.    !log (T) or linear (F) steps
ns=32           !# of scan steps
nres=1          !# of scan substeps
heating=.true. !Calculate heating rates
eigen=.true.   !Calculate eigenfunctions
/
